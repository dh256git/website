---
layout: default
---
{% assign theme_key = page.slug | default: page.title | slugify %}

<article class="theme">
  <h1>{{ page.title }}</h1>

  {% assign has_content = page.content | strip | size %}
  <div class="lead">
    {% if has_content > 0 %}
      {{ page.excerpt | markdownify }}
    {% else %}
      {{ page.description | markdownify }}
    {% endif %}
  </div>

  {%- comment -%} Projects linked by tag {%- endcomment -%}
  {% assign related_projects = "" | split: "" %}
  {% for prj in site.projects %}
    {% assign tagbag = prj.tags | default: empty | join: " " | slugify %}
    {% if tagbag contains theme_key %}
      {% assign related_projects = related_projects | push: prj %}
    {% endif %}
  {% endfor %}
  {% if related_projects.size > 0 %}
  <section aria-labelledby="projects-h">
    <h2 id="projects-h">Projects</h2>
    <ul class="list-unstyled">
      {% for prj in related_projects %}
      <li>
        {% if prj.external_url %}<a href="{{ prj.external_url }}">{% endif %}
        <strong>{{ prj.title }}</strong>
        {% if prj.external_url %}</a>{% endif %}
        {% if prj.summary %} â€” {{ prj.summary }}{% endif %}
      </li>
      {% endfor %}
    </ul>
  </section>
  {% endif %}

  {%- comment -%} Publications linked by tag {%- endcomment -%}
  {% assign related_pubs = "" | split: "" %}
  {% for p in site.publications %}
    {% assign tagbag = p.tags | default: empty | join: " " | slugify %}
    {% if tagbag contains theme_key %}
      {% assign related_pubs = related_pubs | push: p %}
    {% endif %}
  {% endfor %}
  {% assign related_pubs = related_pubs | sort: "year" | reverse %}
  {% if related_pubs.size > 0 %}
  <section aria-labelledby="pubs-h">
    <h2 id="pubs-h">Publications</h2>
    <ul class="pub-list">
      {% for p in related_pubs %}
        {% include pub-card.html p=p show_links=true %}
      {% endfor %}
    </ul>
  </section>
  {% endif %}

  {%- comment -%} Posts & media linked by tag {%- endcomment -%}
  {% assign related_posts = "" | split: "" %}
  {% for post in site.posts %}
    {% assign tagbag = post.tags | default: empty | join: " " | slugify %}
    {% if tagbag contains theme_key %}
      {% assign related_posts = related_posts | push: post %}
    {% endif %}
  {% endfor %}
  {% if related_posts.size > 0 %}
  <section aria-labelledby="media-h">
    <h2 id="media-h">Media</h2>
    <ul>
      {% for post in related_posts %}
        <li>
          <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
          <time datetime="{{ post.date | date_to_xmlschema }}">({{ post.date | date: "%Y-%m-%d" }})</time>
        </li>
      {% endfor %}
    </ul>
  </section>
  {% endif %}
</article>
